@ECHO OFF
SETLOCAL ENABLEEXTENSIONS
SETLOCAL ENABLEDELAYEDEXPANSION

TITLE GrepLauncher AkPac

COLOR 0E

CD %PROGRAMFILES(x86)%
CD ASTROGREP

set LogFile=dud_AkPac.log
set PINGTIME=5

ECHO.
ECHO.
ECHO PLEASE VERIFY THE FOLLOWING:
ECHO - CORRECT DATE IS SET IN APP DATA
ECHO - SUBFOLDER SEARCH SET IN APP DATA
ECHO - TEXT EDITOR IS SET TO NOTEPAD++ WITH COMAND SET TO %%1, -N%%2 IN APP DATA
ECHO - SHOW EXCLUDED PROMPT IN OPTIONS IS UNCHECKED VIA APP DATA
ECHO.
ECHO ****************************************************************
ECHO ** THIS SCRIPT NOW RELIES ON THE SEARCH STRING BEING SAVED IN **
ECHO ** THE ASTROGREP APP DATA. SET APP DATA CONFIGS TO READ ONLY  **
ECHO ****************************************************************
ECHO.
ECHO STARTING WITH SEA COUNTER
ECHO PRESS ANY KEY TO FIRE THE FIRST 15...
PAUSE>NUL

CLS
ECHO.
ECHO.
ECHO LAUNCH IN PROGRESS, PLEASE STAND BY...
ECHO.
ECHO CURENTLY SEARCHING SEA COUNTER
ECHO.


::1
SET WNAME=SEATRASP01W01B
CALL :CHECKONLINE

::2
SET WNAME=SEATRASP01W02B
CALL :CHECKONLINE

::3
SET WNAME=SEATRASP01W03B
CALL :CHECKONLINE

::4
SET WNAME=SEATRASP01W04B
CALL :CHECKONLINE

::5
SET WNAME=SEATRASP01W05R
CALL :CHECKONLINE

::6
SET WNAME=SEATRASP01W06
CALL :CHECKONLINE

::7
SET WNAME=SEATRASP01W07
CALL :CHECKONLINE

::8
SET WNAME=SEATRASP01W08
CALL :CHECKONLINE

::9
::SET WNAME=SEATRASP02W09R
::CALL :CHECKONLINE

::10
SET WNAME=SEATRASP02W10R
CALL :CHECKONLINE

::11
SET WNAME=SEATRASP02W11
CALL :CHECKONLINE

::12
SET WNAME=SEATRASP02W12R
CALL :CHECKONLINE

::13
SET WNAME=SEATRASP02W13
CALL :CHECKONLINE

::14
SET WNAME=SEATRASP02W14R
CALL :CHECKONLINE

::15
SET WNAME=SEATRASP02W15
CALL :CHECKONLINE

cls
ECHO.
ECHO.
ECHO 15 SESSIONS LAUNCHED SO FAR.
ECHO NEXT WILL BE SEA COUNTER
ECHO PRESS ANY KEY TO FIRE THE NEXT 15...
PAUSE>NUL

CLS
ECHO.
ECHO.
ECHO LAUNCH IN PROGRESS, PLEASE STAND BY...
ECHO.
ECHO CURENTLY SEARCHING SEA COUNTER
ECHO.

::16
SET WNAME=SEATRASP02W16R
CALL :CHECKONLINE

::17
SET WNAME=SEATRASP03W17
CALL :CHECKONLINE

::18
SET WNAME=SEATRASP03W18
CALL :CHECKONLINE

::19
SET WNAME=SEATRASP03W19R
CALL :CHECKONLINE

::20
SET WNAME=SEATRASP03W20R
CALL :CHECKONLINE

::21
SET WNAME=SEATRASP03W21R
CALL :CHECKONLINE

::22
SET WNAME=SEATRASP03W22
CALL :CHECKONLINE

::23
SET WNAME=SEATRASP03W23
CALL :CHECKONLINE

::24
SET WNAME=SEATRASP03W24R
CALL :CHECKONLINE

::25
SET WNAME=SEATRASP04W25
CALL :CHECKONLINE

::26
SET WNAME=SEATRASP04W26R
CALL :CHECKONLINE

::27
SET WNAME=SEATRASP04W27
CALL :CHECKONLINE

::28
SET WNAME=SEATRASP04W28
CALL :CHECKONLINE

::29
SET WNAME=SEATRASP04W29R
CALL :CHECKONLINE

::30
SET WNAME=SEATRASP05W30
CALL :CHECKONLINE

cls
ECHO.
ECHO.
ECHO 30 SESSIONS LAUNCHED SO FAR.
ECHO NEXT WILL BE SEA GATES
ECHO PRESS ANY KEY TO FIRE THE NEXT 15...
PAUSE>NUL

CLS
ECHO.
ECHO.
ECHO LAUNCH IN PROGRESS, PLEASE STAND BY...
ECHO.
ECHO CURENTLY SEARCHING SEA COUNTER
ECHO.

::31
SET WNAME=SEATRASP05W31
CALL :CHECKONLINE

::32
SET WNAME=SEATRASP05W32
CALL :CHECKONLINE

ECHO.
ECHO CURENTLY SEARCHING SEA GATES
ECHO.

::33
SET WNAME=SEAGAC09ONW01
CALL :CHECKONLINE

::34
::SET WNAME=SEAGAC10ONW01R
::CALL :CHECKONLINE

::35
SET WNAME=SEAGAC11ONW01
CALL :CHECKONLINE

::36
SET WNAME=SEAGAC12ONW01
CALL :CHECKONLINE

::37
SET WNAME=SEAGAC14ONW01R
CALL :CHECKONLINE

::38
SET WNAME=SEAGAC15ONW01R
CALL :CHECKONLINE

::39
SET WNAME=SEAGAC16ONW01R
CALL :CHECKONLINE

::40
SET WNAME=SEAGAC16ONW02
CALL :CHECKONLINE

::41
SET WNAME=SEAGAC17ONW01R
CALL :CHECKONLINE

::42
SET WNAME=SEAGAC20ONW01R
CALL :CHECKONLINE

::43
SET WNAME=SEAGAN02ONW01R
CALL :CHECKONLINE

::44
SET WNAME=SEAGAN03ONW01R
CALL :CHECKONLINE

::45
SET WNAME=SEAGAN06ONW01
CALL :CHECKONLINE

cls
ECHO.
ECHO.
ECHO 45 SESSIONS LAUNCHED SO FAR.
ECHO NEXT WILL BE SEA GATES
ECHO PRESS ANY KEY TO FIRE THE NEXT 15...
PAUSE>NUL

CLS
ECHO.
ECHO.
ECHO LAUNCH IN PROGRESS, PLEASE STAND BY...
ECHO.
ECHO CURENTLY SEARCHING SEA GATES

::46
SET WNAME=SEAGAN07ONW01
CALL :CHECKONLINE

::47
SET WNAME=SEAGAN07ONW02R
CALL :CHECKONLINE

::48
SET WNAME=SEAGAN07RONW01
CALL :CHECKONLINE

::49
SET WNAME=SEAGAN08ONW01
CALL :CHECKONLINE

::50
SET WNAME=SEAGAN09ONW01
CALL :CHECKONLINE

::51
SET WNAME=SEAGAQXC2BW01
CALL :CHECKONLINE

::52
SET WNAME=SEAGAQXC2BW02
CALL :CHECKONLINE

::53
::SET WNAME=SEAGAQXC2BW03R
::CALL :CHECKONLINE

::54
SET WNAME=SEAGAQXC2DW01R
CALL :CHECKONLINE

::55
SET WNAME=SEAGAQXC2DW02
CALL :CHECKONLINE

::56
SET WNAME=SEAGAQXC2DW03R
CALL :CHECKONLINE

::57
SET WNAME=SEAGAQXC2FW01
CALL :CHECKONLINE

::58
SET WNAME=SEAGAQXC2FW02
CALL :CHECKONLINE

::59
SET WNAME=SEAGAQXC2FW03
CALL :CHECKONLINE

::60
SET WNAME=SEAGAQXC2JW01
CALL :CHECKONLINE

cls
ECHO.
ECHO.
ECHO 60 SESSIONS LAUNCHED SO FAR.
ECHO NEXT WILL BE SEA GATES
ECHO PRESS ANY KEY TO FIRE THE NEXT 15...
PAUSE>NUL

CLS
ECHO.
ECHO.
ECHO LAUNCH IN PROGRESS, PLEASE STAND BY...
ECHO.
ECHO CURENTLY SEARCHING SEA GATES

::61
SET WNAME=SEAGAQXC2JW02R
CALL :CHECKONLINE

::62
SET WNAME=SEAGAQXC2JW03
CALL :CHECKONLINE

::63
SET WNAME=SEAGAQXC2LW03R
CALL :CHECKONLINE

::64
SET WNAME=SEAGAQXC2MW01R
CALL :CHECKONLINE

::65
SET WNAME=SEAGAQXC2MW02
CALL :CHECKONLINE

::66
::SET WNAME=SEAQXC10ONW01R
::CALL :CHECKONLINE

::67
SET WNAME=SEAGAQXN12AW01R
CALL :CHECKONLINE

::68
SET WNAME=SEAGAQXN12BW01R
CALL :CHECKONLINE

::69
SET WNAME=SEAGAQXN12CW01R
CALL :CHECKONLINE

::70
SET WNAME=SEAGAQXN12DW01R
CALL :CHECKONLINE

::71
SET WNAME=SEAGAQXN12EW01
CALL :CHECKONLINE

::72
SET WNAME=SEAGAQXN12FW01R
CALL :CHECKONLINE

::73
SET WNAME=SEAGAQXN12W01
CALL :CHECKONLINE

::74
SET WNAME=SEAGAQXN12W02
CALL :CHECKONLINE

CLS
ECHO.
ECHO.
ECHO LAUNCH IN PROGRESS, PLEASE STAND BY...
ECHO.
ECHO CURENTLY SEARCHING SAN STATION

::75
SET WNAME=SANGA7ASG15ON
CALL :CHECKONLINE

cls
ECHO.
ECHO.
ECHO 75 SESSIONS LAUNCHED SO FAR.
ECHO NEXT WILL BE SAN AND PDX STATION
ECHO PRESS ANY KEY TO FIRE THE NEXT 15...
PAUSE>NUL

CLS
ECHO.
ECHO.
ECHO LAUNCH IN PROGRESS, PLEASE STAND BY...
ECHO.
ECHO CURENTLY SEARCHING SAN STATION
ECHO.

::76
SET WNAME=SANGA7ASG14ON
CALL :CHECKONLINE

::77
SET WNAME=SANGA7ASG13ON
CALL :CHECKONLINE

::78
SET WNAME=SANGA7ASG17ON
CALL :CHECKONLINE

::79
SET WNAME=SANGA7ASG16ON
CALL :CHECKONLINE

::80
SET WNAME=SANGA7ASG18W2
CALL :CHECKONLINE

ECHO.
ECHO CURENTLY SEARCHING PDX STATION
ECHO.

::81
SET WNAME=PDXTR7AS001W08
CALL :CHECKONLINE

::82
SET WNAME=PDXTR7AS001W09
CALL :CHECKONLINE

::83
SET WNAME=PDXTR7AS001W10
CALL :CHECKONLINE

::84
SET WNAME=PDXTR7AS001W11
CALL :CHECKONLINE

::85
SET WNAME=PDXTR7AS001W12
CALL :CHECKONLINE

::86
SET WNAME=PDXTR7AS001W13
CALL :CHECKONLINE

::87
SET WNAME=PDXTR7AS001W14
CALL :CHECKONLINE

::88
SET WNAME=PDXTR7AS001W15
CALL :CHECKONLINE

::89
SET WNAME=PDXTR7AS001W16
CALL :CHECKONLINE

::90
SET WNAME=PDXTR7AS001W17
CALL :CHECKONLINE



cls
ECHO.
ECHO.
ECHO 90 SESSIONS LAUNCHED SO FAR.
ECHO NEXT WILL BE PDX AND ANC STATIONS
ECHO PRESS ANY KEY TO FIRE THE NEXT 15...
PAUSE>NUL

CLS
ECHO.
ECHO.
ECHO LAUNCH IN PROGRESS, PLEASE STAND BY...
ECHO.
ECHO CURENTLY SEARCHING PDX STATION
ECHO.

::91
SET WNAME=PDXTR7AS001W18
CALL :CHECKONLINE

::92
SET WNAME=PDXTR7AS001W19
CALL :CHECKONLINE

::93
SET WNAME=PDXTR7AS001W20
CALL :CHECKONLINE

::94
SET WNAME=PDXTR7AS001W21
CALL :CHECKONLINE

::95
SET WNAME=PDXTR7AS001W22
CALL :CHECKONLINE

::96
SET WNAME=PDXTR7AS001W23
CALL :CHECKONLINE

ECHO.
ECHO CURENTLY SEARCHING ANC STATION
ECHO.

::97
SET WNAME=ANCTRASPODW01
CALL :CHECKONLINE

::98
SET WNAME=ANCTRASPODW02
CALL :CHECKONLINE

::99
SET WNAME=ANCTRASPODW03
CALL :CHECKONLINE

::100
SET WNAME=ANCTRASPODW04R
CALL :CHECKONLINE

::101
SET WNAME=ANCTRASPODW05
CALL :CHECKONLINE

::102
SET WNAME=ANCTRASPODW06
CALL :CHECKONLINE

::103
SET WNAME=ANCTRASPODW07
CALL :CHECKONLINE

::104
SET WNAME=ANCTRASPODW08
CALL :CHECKONLINE

::105
SET WNAME=ANCTRASPODW09X
CALL :CHECKONLINE

ECHO.
ECHO.
ECHO 105 SESSIONS LAUNCHED SO FAR.
ECHO NEXT WILL BE ANC, JNU, AND SIT STATION
ECHO PRESS ANY KEY TO FIRE THE NEXT 15...
PAUSE>NUL

CLS
ECHO.
ECHO.
ECHO LAUNCH IN PROGRESS, PLEASE STAND BY...
ECHO.
ECHO CURENTLY SEARCHING ANC STATION
ECHO.


::106
SET WNAME=ANCTRASPODW10R
CALL :CHECKONLINE

ECHO.
ECHO CURENTLY SEARCHING JNU STATION
ECHO.

::107
SET WNAME=JNUTRASPODW01
CALL :CHECKONLINE

cls
ECHO.
ECHO.
ECHO 105 SESSIONS LAUNCHED SO FAR.
ECHO NEXT WILL BE JNU AND SIT STATION
ECHO PRESS ANY KEY TO FIRE THE NEXT 15...
PAUSE>NUL

CLS
ECHO.
ECHO.
ECHO LAUNCH IN PROGRESS, PLEASE STAND BY...
ECHO.
ECHO CURENTLY SEARCHING JNU STATION
ECHO.

::108
SET WNAME=JNUTRASPODW02
CALL :CHECKONLINE

::109
SET WNAME=JNUTRASPODW03
CALL :CHECKONLINE

::110
SET WNAME=JNUTRASPODW04
CALL :CHECKONLINE

::111
SET WNAME=JNUTRASPODW05
CALL :CHECKONLINE

ECHO.
ECHO NOW SEARCHING SIT STATION
ECHO.

::112
SET WNAME=SITTRASPODW01
CALL :CHECKONLINE

::113
SET WNAME=SITTRASPODW02
CALL :CHECKONLINE

CLS
ECHO.
ECHO.
ECHO 113 SESSIONS LAUNCHED
ECHO WE'RE ALL DONE HERE...
ECHO.


:: ****************************************************************
::  E N D   O F   A P P L I C A T I O N
:: ****************************************************************
:DONE
ECHO. >> !LogFile!
ECHO.&ECHO.PRESS ANY KEY TO END THE APPLICATION.
ENDLOCAL
PAUSE>NUL&GOTO:EOF


:: ****************************************************************
:: CHKONLINE WILL VERIFY THAT WORKSTATION IS ONLINE
:: ****************************************************************
:CHECKONLINE
PING !WNAME! -n 1 -w 1000 >NUL
IF ERRORLEVEL 1 (
  ECHO !WNAME! IS NOT ONLINE
  ECHO !date! !time! WORKSTATION !WNAME! IS NOT ONLINE >> !LogFile!
  GOTO:EOF
)
CALL:LAUNCHASTRO
GOTO:EOF


:: ****************************************************************
:: LAUNCHASTRO WILL LAUNCH ASTROGREP WITH WORKSTATION PARAM
:: ****************************************************************
:LAUNCHASTRO
start AstroGrep.exe /spath="\\!WNAME!\c$\Airgroup\Log\ImageApt" /stypes="*_IMAGE.log, *_BDA.log, *_OBM.log" /e /l /cl="2" /s
ping -n !PINGTIME! 127.0.0.1>NUL
GOTO:EOF
